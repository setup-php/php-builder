From: Jan Ehrhardt <github@ehrhardt.nl>
Date: Sun, 9 Jun 2024 20:00:22 +0200
Subject: Mark CVE-2024-5585 backport tests for PHP 7.4 as EXPECTED FAIL See
 https://github.com/remicollet/php-src-security/issues/17#issuecomment-2151840402

---
 ext/standard/tests/general_functions/ghsa-9fcc-425m-g385_001.phpt | 2 ++
 ext/standard/tests/general_functions/ghsa-9fcc-425m-g385_002.phpt | 2 ++
 ext/standard/tests/general_functions/ghsa-9fcc-425m-g385_003.phpt | 2 ++
 3 files changed, 6 insertions(+)

diff --git a/ext/standard/tests/general_functions/ghsa-9fcc-425m-g385_001.phpt b/ext/standard/tests/general_functions/ghsa-9fcc-425m-g385_001.phpt
index 2873210..0a88d6b 100644
--- a/ext/standard/tests/general_functions/ghsa-9fcc-425m-g385_001.phpt
+++ b/ext/standard/tests/general_functions/ghsa-9fcc-425m-g385_001.phpt
@@ -6,6 +6,8 @@ if( substr(PHP_OS, 0, 3) != "WIN" )
   die('skip Run only on Windows');
 if (getenv("SKIP_SLOW_TESTS")) die("skip slow test");
 ?>
+--XFAIL--
+Before PHP 8.0.0 we would need to add extra quotes.
 --FILE--
 <?php
 
diff --git a/ext/standard/tests/general_functions/ghsa-9fcc-425m-g385_002.phpt b/ext/standard/tests/general_functions/ghsa-9fcc-425m-g385_002.phpt
index 7148365..6fbb420 100644
--- a/ext/standard/tests/general_functions/ghsa-9fcc-425m-g385_002.phpt
+++ b/ext/standard/tests/general_functions/ghsa-9fcc-425m-g385_002.phpt
@@ -6,6 +6,8 @@ if( substr(PHP_OS, 0, 3) != "WIN" )
   die('skip Run only on Windows');
 if (getenv("SKIP_SLOW_TESTS")) die("skip slow test");
 ?>
+--XFAIL--
+Before PHP 8.0.0 we would need to add extra quotes.
 --FILE--
 <?php
 
diff --git a/ext/standard/tests/general_functions/ghsa-9fcc-425m-g385_003.phpt b/ext/standard/tests/general_functions/ghsa-9fcc-425m-g385_003.phpt
index a632965..038db4f 100644
--- a/ext/standard/tests/general_functions/ghsa-9fcc-425m-g385_003.phpt
+++ b/ext/standard/tests/general_functions/ghsa-9fcc-425m-g385_003.phpt
@@ -5,6 +5,8 @@ GHSA-9fcc-425m-g385 - bypass CVE-2024-1874 - exhaustive suffix test
 if( substr(PHP_OS, 0, 3) != "WIN" )
   die('skip Run only on Windows');
 ?>
+--XFAIL--
+Before PHP 8.0.0 we would need to add extra quotes.
 --FILE--
 <?php
 
